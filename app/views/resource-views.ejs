<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'/>
  <link href='/css/style.css' rel='stylesheet'/>
  <link href='/js/fullCalendarResources/dist/fullcalendar.css' rel='stylesheet'/>
  <link href='/js/fullCalendarResources/dist/fullcalendar.print.css' rel='stylesheet' media='print'/>
  <script src='/js/fullCalendarResources/lib/moment/moment.js'></script>
  <script src='/js/fullCalendarResources/lib/jquery/dist/jquery.js'></script>
  <script src='/js/fullCalendarResources/lib/jquery-ui/ui/jquery-ui.js'></script>
  <script src='/js/fullCalendarResources/dist/fullcalendar.js'></script>
  <script>
    $(document).ready(function () {
      var date = new Date();
      var d = date.getDate();
      var m = date.getMonth();
      var y = date.getFullYear();

      $('#calendar').fullCalendar({
        header: {
          left: 'prev,next today',
          center: 'title',
          right: 'month,agendaWeek,resourceDay'
        },
        defaultView: 'resourceDay',
        editable: true,
        droppable: true,
        resources: 'calendar/rooms',
        resourceFilter: function (resource) {
          var active = $("input").map(function(){
            return this.checked ? this.name : null;
          }).get();
          return $.inArray(resource.id, active) > -1;
        },
        events: 'calendar/booking',
        // the 'ev' parameter is the mouse event rather than the resource 'event'
        // the ev.data is the resource column clicked upon
        selectable: true,
        selectHelper: true,
        select: function (start, end, ev) {
		  console.log("start event:");
          console.log(start);
		  console.log("end event:");
          console.log(end);
		  console.log("event resources");
          console.log(ev); // resources
        },
        eventClick: function (event) {
		  console.log("event clicked");
          console.log(event);
  		  event.title = "CLICKED!";
        },
        eventDrop: function (event, delta, revertFunc) {
		  console.log("event dropped");
          console.log(event);
        },
	    eventResize: function (event, delta, revertFunc) {
		}
      });
    });

    $(document).ready(function() {
      $('input:checkbox').change(function(){
        $('#calendar').fullCalendar('render');
      });
    });

  </script>
</head>
<body>
<form>Select the resources you wanna filter:
  <% for(var i=0; i<resources.length; i++) {%>
  <input name="<%=resources[i].id%>" type="checkbox" checked /> <%= resources[i].name %>
  <% } %>
</form>
<div id='calendar'></div>

</body>
</html>
